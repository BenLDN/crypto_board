<!doctype html>

<!--Temp style to separate messages-->
<style>
  .bordered {
    width: 500px;
    height: 150px;
    padding: 5px;
    border: 3px solid black;
  }
</style>

<html>
   	<body>
   	<h1>Crypto Message Board</h1>
	
	<!--Show login page if not logged in-->
	<!--Show user name if logged in-->
    {% if session.get("current_user", None) == None %}
            <form action="/login" method="post">
                <input type="text" name="user_name" placeholder="User Name"><br>
                <input type="password" name="user_password" placeholder="Password"><br>
                <button type="submit">Log In</button>
            </form>
    {% else %}
    	<li>
          <a>You are logged in as: <b> {{ session.get("current_user") }}</b></a></li>
          <li><a href="/logout"><b><u>Logout</u></b></a>
      	</li>

    <!--Input form for a message and a transaction-->
    <h2>New Message</h2>
	<form action="{{ url_for('new_msg') }}" method="POST">
	 	Type your message here:<br>
	 	<textarea name="message_content" placeholder="Type your message here" rows="5" cols="50"></textarea><br>
		<input type="number" name="transaction_amount" placeholder="Amount to buy/sell">
		<input type="radio" id="buy" name="transaction_type" value="buy" checked="checked"> <label for="buy">buy</label>
		<input type="radio" id="sell" name="transaction_type" value="sell"> <label for="sell">sell</label>
	 	<br><br>
	 	<input type="submit" value="Submit">
	</form> 
    {% endif %}

    <!--Lits of all messages from the DB-->
	<h2>Message List</h2>

	{% if session.get("current_user") == "admin" %}
	<a href="{{ url_for('clear') }}">clear messages</a>
	<br><br>
	{% endif %}

	<!--Looping through the list of messages and diplaying each message separately-->
	{% for row in rows %}

	<div class="bordered">
		<b> {{ row["user_name"] }} </b><br>
		<i> Date: {{ row["message_date"] }} </i><br>
		<i> BTC Price: {{ row["btc_price"] }} </i><br>
		Buy/(sell): {{ row["transaction_amount"] }}
		BTC: {{ row["new_btc"] }}
		Cash: {{ row["new_cash"] }}
		Net worth: {{ row["net_worth"] }}
		<br>
		{{ row["message_content"] }}

	</div>
	<br>

	{% endfor %}
      
   	</body>
	
</html>